<?xml version="1.0" encoding="utf-8"?><testsuites name="pytest tests"><testsuite name="pytest" errors="0" failures="1" skipped="0" tests="1" time="0.926" timestamp="2025-09-14T15:45:45.392093-07:00" hostname="Mac.lan"><testcase classname="unit.test_security.TestSecurityHeaders" name="test_security_headers_present" time="0.564"><failure message="assert ('X-XSS-Protection' in Headers({'content-type': 'text/html; charset=utf-8', 'x-correlation-id': '6b89cf77-ce86-4cfd-b5d5-1e93ca832b18', 'vary': 'Accept-Encoding', 'content-encoding': 'gzip', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-content-type-options': 'nosniff', 'x-frame-options': 'DENY', 'referrer-policy': 'no-referrer', 'permissions-policy': 'camera=(), microphone=(), geolocation=()', 'cross-origin-opener-policy': 'same-origin', 'content-security-policy': &quot;default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: blob:; connect-src 'self' ws: wss:; frame-ancestors 'none';&quot;}) or 'x-xss-protection' in Headers({'content-type': 'text/html; charset=utf-8', 'x-correlation-id': '6b89cf77-ce86-4cfd-b5d5-1e93ca832b18', 'vary': 'Accept-Encoding', 'content-encoding': 'gzip', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-content-type-options': 'nosniff', 'x-frame-options': 'DENY', 'referrer-policy': 'no-referrer', 'permissions-policy': 'camera=(), microphone=(), geolocation=()', 'cross-origin-opener-policy': 'same-origin', 'content-security-policy': &quot;default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: blob:; connect-src 'self' ws: wss:; frame-ancestors 'none';&quot;}))&#10; +  where Headers({'content-type': 'text/html; charset=utf-8', 'x-correlation-id': '6b89cf77-ce86-4cfd-b5d5-1e93ca832b18', 'vary': 'Accept-Encoding', 'content-encoding': 'gzip', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-content-type-options': 'nosniff', 'x-frame-options': 'DENY', 'referrer-policy': 'no-referrer', 'permissions-policy': 'camera=(), microphone=(), geolocation=()', 'cross-origin-opener-policy': 'same-origin', 'content-security-policy': &quot;default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: blob:; connect-src 'self' ws: wss:; frame-ancestors 'none';&quot;}) = &lt;Response [200 OK]&gt;.headers&#10; +  and   'x-xss-protection' = &lt;built-in method lower of str object at 0x34d08dcf0&gt;()&#10; +    where &lt;built-in method lower of str object at 0x34d08dcf0&gt; = 'X-XSS-Protection'.lower&#10; +  and   Headers({'content-type': 'text/html; charset=utf-8', 'x-correlation-id': '6b89cf77-ce86-4cfd-b5d5-1e93ca832b18', 'vary': 'Accept-Encoding', 'content-encoding': 'gzip', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-content-type-options': 'nosniff', 'x-frame-options': 'DENY', 'referrer-policy': 'no-referrer', 'permissions-policy': 'camera=(), microphone=(), geolocation=()', 'cross-origin-opener-policy': 'same-origin', 'content-security-policy': &quot;default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: blob:; connect-src 'self' ws: wss:; frame-ancestors 'none';&quot;}) = &lt;Response [200 OK]&gt;.headers">self = &lt;unit.test_security.TestSecurityHeaders object at 0x34d0b5490&gt;

    def test_security_headers_present(self):
        """Test that security headers are properly set."""
        from fastapi.testclient import TestClient
        from app.main import app
    
        client = TestClient(app)
        response = client.get("/")
    
        # Check for important security headers
        expected_headers = [
            "X-Content-Type-Options",
            "X-Frame-Options",
            "X-XSS-Protection",
            "Strict-Transport-Security"
        ]
    
        for header in expected_headers:
&gt;           assert header in response.headers or header.lower() in response.headers
E           assert ('X-XSS-Protection' in Headers({'content-type': 'text/html; charset=utf-8', 'x-correlation-id': '6b89cf77-ce86-4cfd-b5d5-1e93ca832b18', 'vary': 'Accept-Encoding', 'content-encoding': 'gzip', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-content-type-options': 'nosniff', 'x-frame-options': 'DENY', 'referrer-policy': 'no-referrer', 'permissions-policy': 'camera=(), microphone=(), geolocation=()', 'cross-origin-opener-policy': 'same-origin', 'content-security-policy': "default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: blob:; connect-src 'self' ws: wss:; frame-ancestors 'none';"}) or 'x-xss-protection' in Headers({'content-type': 'text/html; charset=utf-8', 'x-correlation-id': '6b89cf77-ce86-4cfd-b5d5-1e93ca832b18', 'vary': 'Accept-Encoding', 'content-encoding': 'gzip', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-content-type-options': 'nosniff', 'x-frame-options': 'DENY', 'referrer-policy': 'no-referrer', 'permissions-policy': 'camera=(), microphone=(), geolocation=()', 'cross-origin-opener-policy': 'same-origin', 'content-security-policy': "default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: blob:; connect-src 'self' ws: wss:; frame-ancestors 'none';"}))
E            +  where Headers({'content-type': 'text/html; charset=utf-8', 'x-correlation-id': '6b89cf77-ce86-4cfd-b5d5-1e93ca832b18', 'vary': 'Accept-Encoding', 'content-encoding': 'gzip', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-content-type-options': 'nosniff', 'x-frame-options': 'DENY', 'referrer-policy': 'no-referrer', 'permissions-policy': 'camera=(), microphone=(), geolocation=()', 'cross-origin-opener-policy': 'same-origin', 'content-security-policy': "default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: blob:; connect-src 'self' ws: wss:; frame-ancestors 'none';"}) = &lt;Response [200 OK]&gt;.headers
E            +  and   'x-xss-protection' = &lt;built-in method lower of str object at 0x34d08dcf0&gt;()
E            +    where &lt;built-in method lower of str object at 0x34d08dcf0&gt; = 'X-XSS-Protection'.lower
E            +  and   Headers({'content-type': 'text/html; charset=utf-8', 'x-correlation-id': '6b89cf77-ce86-4cfd-b5d5-1e93ca832b18', 'vary': 'Accept-Encoding', 'content-encoding': 'gzip', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-content-type-options': 'nosniff', 'x-frame-options': 'DENY', 'referrer-policy': 'no-referrer', 'permissions-policy': 'camera=(), microphone=(), geolocation=()', 'cross-origin-opener-policy': 'same-origin', 'content-security-policy': "default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: blob:; connect-src 'self' ws: wss:; frame-ancestors 'none';"}) = &lt;Response [200 OK]&gt;.headers

tests/unit/test_security.py:426: AssertionError</failure></testcase></testsuite></testsuites>